@page "/admin"
@attribute [Authorize(Roles = "Admin")]
@layout EmptyLayout

@inject VehiculoService vehiculoService

<div class="container-fluid p-4">

    <div class="text-center mb-4">
        <img src="images/auto-franklin-logo-removebg-preview.png"
             alt="AutoFranklin Logo"
             style="width:180px; height:auto;" />
    </div>

    <h1 class="fw-bold text-center text-dark mb-5">
        Bienvenido al Panel De Administrador
    </h1>

    <div class="row g-4 justify-content-center">
        <!-- Deshabilitados -->
        <div class="col-12 col-sm-6 col-lg-4">
            <a href="/deshabilitados" class="text-decoration-none">
                <div class="card shadow-lg border-0 home-card text-center">
                    <div class="card-body p-4">
                        <i class="fa-solid fa-circle-xmark text-danger" style="font-size:50px;"></i>
                        <h4 class="mt-3 fw-bold text-dark">Deshabilitados</h4>
                        <p class="text-muted">Administra las entidades deshabilitadas.</p>
                    </div>
                </div>
            </a>
        </div>

        <!-- Vehiculos -->
        <div class="col-12 col-sm-6 col-lg-4">
            <a href="/vehiculos" class="text-decoration-none">
                <div class="card shadow-lg border-0 home-card text-center">
                    <div class="card-body p-4">
                        <i class="fa-solid fa-car text-danger" style="font-size:50px;"></i>
                        <h4 class="mt-3 fw-bold text-dark">Veh&iacute;culos</h4>
                        <p class="text-muted">Gestiona los veh&iacute;culos del sistema.</p>
                    </div>
                </div>
            </a>
        </div>

    </div>
</div>

@code {
    public int TotalVehiculos { get; set; }
    public int VehiculosActivos { get; set; }
    public int VehiculosInactivos { get; set; }

    public List<Vehiculo> UltimosVehiculos { get; set; } = new();

    protected override async Task OnInitializedAsync()
    {
        var vehiculos = await vehiculoService.ListarVehiculos(v => true);

        TotalVehiculos = vehiculos.Count;
        VehiculosActivos = vehiculos.Count(v => v.isActive);
        VehiculosInactivos = vehiculos.Count(v => !v.isActive);

        UltimosVehiculos = vehiculos
            .OrderByDescending(v => v.VehiculoId)
            .Take(5)
            .ToList();
    }
}